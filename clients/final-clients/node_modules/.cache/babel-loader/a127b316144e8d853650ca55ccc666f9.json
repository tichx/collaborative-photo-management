{"ast":null,"code":"import _regeneratorRuntime from \"/Users/danfengyang/go/src/INFO441/collaborative-photo-management/clients/final-clients/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/danfengyang/go/src/INFO441/collaborative-photo-management/clients/final-clients/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"/Users/danfengyang/go/src/INFO441/collaborative-photo-management/clients/final-clients/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/danfengyang/go/src/INFO441/collaborative-photo-management/clients/final-clients/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/danfengyang/go/src/INFO441/collaborative-photo-management/clients/final-clients/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/danfengyang/go/src/INFO441/collaborative-photo-management/clients/final-clients/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/danfengyang/go/src/INFO441/collaborative-photo-management/clients/final-clients/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/Users/danfengyang/go/src/INFO441/collaborative-photo-management/clients/final-clients/src/Components/Main/Components/UpdateAvatar/UpdateAvatar.js\";\nimport React, { Component } from 'react';\nimport api from '../../../../Constants/APIEndpoints/APIEndpoints';\nimport Errors from '../../../Errors/Errors';\n\nvar UpdateAvatar =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(UpdateAvatar, _Component);\n\n  function UpdateAvatar(props) {\n    var _this;\n\n    _classCallCheck(this, UpdateAvatar);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(UpdateAvatar).call(this, props));\n\n    _this.sendRequest =\n    /*#__PURE__*/\n    function () {\n      var _ref = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee(e) {\n        var file, data, response, error;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                e.preventDefault();\n                file = _this.state.file;\n                data = new FormData();\n                data.append('uploadfile', file);\n                _context.next = 6;\n                return fetch(api.base + api.handlers.myuserAvatar, {\n                  method: \"PUT\",\n                  body: data,\n                  headers: new Headers({\n                    \"Authorization\": localStorage.getItem(\"Authorization\")\n                  })\n                });\n\n              case 6:\n                response = _context.sent;\n\n                if (!(response.status >= 300)) {\n                  _context.next = 14;\n                  break;\n                }\n\n                _context.next = 10;\n                return response.text();\n\n              case 10:\n                error = _context.sent;\n                console.log(error);\n\n                _this.setError(error);\n\n                return _context.abrupt(\"return\");\n\n              case 14:\n                alert(\"Avatar changed\"); // TODO make this better by refactoring errors\n\n              case 15:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee);\n      }));\n\n      return function (_x) {\n        return _ref.apply(this, arguments);\n      };\n    }();\n\n    _this.handleFile = function (e) {\n      _this.setState({\n        file: e.target.files[0]\n      });\n    };\n\n    _this.setError = function (error) {\n      _this.setState({\n        error: error\n      });\n    };\n\n    _this.state = {\n      file: null,\n      error: ''\n    };\n    return _this;\n  }\n\n  _createClass(UpdateAvatar, [{\n    key: \"render\",\n    value: function render() {\n      var error = this.state.error;\n      return React.createElement(React.Fragment, null, React.createElement(Errors, {\n        error: error,\n        setError: this.setError,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 48\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 49\n        },\n        __self: this\n      }, \"Give yourself a new avatar\"), React.createElement(\"form\", {\n        onSubmit: this.sendRequest,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 50\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 51\n        },\n        __self: this\n      }, React.createElement(\"span\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 52\n        },\n        __self: this\n      }, \"Upload new avatar \"), React.createElement(\"input\", {\n        type: \"file\",\n        onChange: this.handleFile,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 53\n        },\n        __self: this\n      })), React.createElement(\"input\", {\n        type: \"submit\",\n        value: \"Change avatar\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 55\n        },\n        __self: this\n      })));\n    }\n  }]);\n\n  return UpdateAvatar;\n}(Component);\n\nexport default UpdateAvatar;","map":{"version":3,"sources":["/Users/danfengyang/go/src/INFO441/collaborative-photo-management/clients/final-clients/src/Components/Main/Components/UpdateAvatar/UpdateAvatar.js"],"names":["React","Component","api","Errors","UpdateAvatar","props","sendRequest","e","preventDefault","file","state","data","FormData","append","fetch","base","handlers","myuserAvatar","method","body","headers","Headers","localStorage","getItem","response","status","text","error","console","log","setError","alert","handleFile","setState","target","files"],"mappings":";;;;;;;;AAAA,OAAOA,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;AACA,OAAOC,GAAP,MAAgB,iDAAhB;AACA,OAAOC,MAAP,MAAmB,wBAAnB;;IAEMC,Y;;;;;AACF,wBAAYC,KAAZ,EAAmB;AAAA;;AAAA;;AACf,sFAAMA,KAAN;;AADe,UAQnBC,WARmB;AAAA;AAAA;AAAA;AAAA;AAAA,+BAQL,iBAAOC,CAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AACVA,gBAAAA,CAAC,CAACC,cAAF;AACQC,gBAAAA,IAFE,GAEO,MAAKC,KAFZ,CAEFD,IAFE;AAGNE,gBAAAA,IAHM,GAGC,IAAIC,QAAJ,EAHD;AAIVD,gBAAAA,IAAI,CAACE,MAAL,CAAY,YAAZ,EAA0BJ,IAA1B;AAJU;AAAA,uBAKaK,KAAK,CAACZ,GAAG,CAACa,IAAJ,GAAWb,GAAG,CAACc,QAAJ,CAAaC,YAAzB,EAAuC;AAC/DC,kBAAAA,MAAM,EAAE,KADuD;AAE/DC,kBAAAA,IAAI,EAAER,IAFyD;AAG/DS,kBAAAA,OAAO,EAAE,IAAIC,OAAJ,CAAY;AACjB,qCAAiBC,YAAY,CAACC,OAAb,CAAqB,eAArB;AADA,mBAAZ;AAHsD,iBAAvC,CALlB;;AAAA;AAKJC,gBAAAA,QALI;;AAAA,sBAYNA,QAAQ,CAACC,MAAT,IAAmB,GAZb;AAAA;AAAA;AAAA;;AAAA;AAAA,uBAacD,QAAQ,CAACE,IAAT,EAbd;;AAAA;AAaAC,gBAAAA,KAbA;AAcNC,gBAAAA,OAAO,CAACC,GAAR,CAAYF,KAAZ;;AACA,sBAAKG,QAAL,CAAcH,KAAd;;AAfM;;AAAA;AAkBVI,gBAAAA,KAAK,CAAC,gBAAD,CAAL,CAlBU,CAkBe;;AAlBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OARK;;AAAA;AAAA;AAAA;AAAA;;AAAA,UA6BnBC,UA7BmB,GA6BN,UAACzB,CAAD,EAAO;AAChB,YAAK0B,QAAL,CAAc;AACVxB,QAAAA,IAAI,EAAEF,CAAC,CAAC2B,MAAF,CAASC,KAAT,CAAe,CAAf;AADI,OAAd;AAGH,KAjCkB;;AAAA,UAmCnBL,QAnCmB,GAmCR,UAACH,KAAD,EAAW;AAClB,YAAKM,QAAL,CAAc;AAAEN,QAAAA,KAAK,EAALA;AAAF,OAAd;AACH,KArCkB;;AAEf,UAAKjB,KAAL,GAAa;AACTD,MAAAA,IAAI,EAAE,IADG;AAETkB,MAAAA,KAAK,EAAE;AAFE,KAAb;AAFe;AAMlB;;;;6BAiCQ;AAAA,UACGA,KADH,GACa,KAAKjB,KADlB,CACGiB,KADH;AAEL,aAAO,0CACH,oBAAC,MAAD;AAAQ,QAAA,KAAK,EAAEA,KAAf;AAAsB,QAAA,QAAQ,EAAE,KAAKG,QAArC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADG,EAEH;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sCAFG,EAGH;AAAM,QAAA,QAAQ,EAAE,KAAKxB,WAArB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,8BADJ,EAEI;AAAO,QAAA,IAAI,EAAC,MAAZ;AAAmB,QAAA,QAAQ,EAAE,KAAK0B,UAAlC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAFJ,CADJ,EAKI;AAAO,QAAA,IAAI,EAAC,QAAZ;AAAqB,QAAA,KAAK,EAAC,eAA3B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QALJ,CAHG,CAAP;AAWH;;;;EArDsB/B,S;;AAyD3B,eAAeG,YAAf","sourcesContent":["import React, { Component } from 'react';\nimport api from '../../../../Constants/APIEndpoints/APIEndpoints';\nimport Errors from '../../../Errors/Errors';\n\nclass UpdateAvatar extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            file: null,\n            error: ''\n        }\n    }\n\n    sendRequest = async (e) => {\n        e.preventDefault();\n        const { file } = this.state;\n        let data = new FormData()\n        data.append('uploadfile', file);\n        const response = await fetch(api.base + api.handlers.myuserAvatar, {\n            method: \"PUT\",\n            body: data,\n            headers: new Headers({\n                \"Authorization\": localStorage.getItem(\"Authorization\"),\n            })\n        });\n        if (response.status >= 300) {\n            const error = await response.text();\n            console.log(error);\n            this.setError(error);\n            return;\n        }\n        alert(\"Avatar changed\"); // TODO make this better by refactoring errors\n    }\n\n    handleFile = (e) => {\n        this.setState({\n            file: e.target.files[0]\n        })\n    }\n\n    setError = (error) => {\n        this.setState({ error })\n    }\n\n    render() {\n        const { error } = this.state;\n        return <>\n            <Errors error={error} setError={this.setError} />\n            <div>Give yourself a new avatar</div>\n            <form onSubmit={this.sendRequest}>\n                <div>\n                    <span>Upload new avatar </span>\n                    <input type=\"file\" onChange={this.handleFile} />\n                </div>\n                <input type=\"submit\" value=\"Change avatar\" />\n            </form>\n        </>\n    }\n\n}\n\nexport default UpdateAvatar;"]},"metadata":{},"sourceType":"module"}